import React, { useState } from 'react';
import '../css/BoardMain.css';

export default function BoardMain() {
  const [boards, setBoards] = useState([]);
  const [selectedBoard, setSelectedBoard] = useState(null);
  const [showCreateModal, setShowCreateModal] = useState(false);
  const [newBoardName, setNewBoardName] = useState('');
  const [newBoardDesc, setNewBoardDesc] = useState('');

  const handleCreateBoard = () => {
    if (newBoardName.trim()) {
      const newBoard = {
        id: Date.now(),
        name: newBoardName,
        description: newBoardDesc,
        createdAt: new Date().toISOString(),
        posts: []
      };
      setBoards([...boards, newBoard]);
      setNewBoardName('');
      setNewBoardDesc('');
      setShowCreateModal(false);
      setSelectedBoard(newBoard);
    }
  };

  const handleDeleteBoard = (boardId, e) => {
    e.stopPropagation();
    if (window.confirm('ì •ë§ ì´ ê²Œì‹œíŒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      setBoards(boards.filter(b => b.id !== boardId));
      if (selectedBoard?.id === boardId) {
        setSelectedBoard(null);
      }
    }
  };

  return (
    <div className="board-main-container">
      <div className="board-content-wrapper">
        {/* ì¢Œì¸¡ ì‚¬ì´ë“œë°” */}
        <aside className="board-sidebar">
          <div className="sidebar-header">
            <h1 className="sidebar-title">ê²Œì‹œíŒ</h1>
            <p className="sidebar-subtitle">ê²Œì‹œíŒì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</p>
          </div>

          <div className="sidebar-actions">
            <button
              onClick={() => setShowCreateModal(true)}
              className="btn-create-board"
            >
              <span className="btn-icon">+</span>
              ìƒˆ ê²Œì‹œíŒ ë§Œë“¤ê¸°
            </button>
          </div>

          <div className="board-list-container">
            {boards.length === 0 ? (
              <div className="empty-state">
                <div className="empty-icon">ğŸ“‹</div>
                <p className="empty-text">ì•„ì§ ìƒì„±ëœ ê²Œì‹œíŒì´ ì—†ìŠµë‹ˆë‹¤</p>
                <p className="empty-subtext">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
              </div>
            ) : (
              <div className="board-list">
                {boards.map((board) => (
                  <div
                    key={board.id}
                    onClick={() => setSelectedBoard(board)}
                    className={`board-item ${selectedBoard?.id === board.id ? 'active' : ''}`}
                  >
                    <div className="board-item-content">
                      <h3 className="board-item-title">{board.name}</h3>
                      {board.description && (
                        <p className="board-item-desc">{board.description}</p>
                      )}
                      <div className="board-item-meta">
                        <span>ê²Œì‹œê¸€ {board.posts.length}ê°œ</span>
                      </div>
                    </div>
                    <button
                      onClick={(e) => handleDeleteBoard(board.id, e)}
                      className="btn-delete-board"
                      title="ê²Œì‹œíŒ ì‚­ì œ"
                    >
                      Ã—
                    </button>
                  </div>
                ))}
              </div>
            )}
          </div>
        </aside>

        {/* ë©”ì¸ ê²Œì‹œíŒ ì˜ì—­ */}
        <main className="board-main-area">
          {selectedBoard ? (
            <div className="board-content">
              <div className="board-header-card">
                <div className="board-header-content">
                  <div>
                    <h2 className="board-title">{selectedBoard.name}</h2>
                    {selectedBoard.description && (
                      <p className="board-description">{selectedBoard.description}</p>
                    )}
                  </div>
                  <button className="btn-settings" title="ì„¤ì •">âš™ï¸</button>
                </div>
                <div className="board-meta">
                  <span>ê²Œì‹œê¸€ {selectedBoard.posts.length}ê°œ</span>
                  <span className="meta-divider">â€¢</span>
                  <span>ìƒì„±ì¼ {new Date(selectedBoard.createdAt).toLocaleDateString('ko-KR')}</span>
                </div>
              </div>

              <div className="posts-card">
                <div className="posts-header">
                  <button className="btn-write-post">ê¸€ì“°ê¸°</button>
                </div>
                
                {selectedBoard.posts.length === 0 ? (
                  <div className="empty-posts">
                    <div className="empty-icon">âœï¸</div>
                    <p className="empty-text">ì•„ì§ ì‘ì„±ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p>
                    <p className="empty-subtext">ì²« ë²ˆì§¸ ê²Œì‹œê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”</p>
                  </div>
                ) : (
                  <div className="posts-list">
                    {selectedBoard.posts.map((post) => (
                      <div key={post.id} className="post-item">
                        <h3 className="post-title">{post.title}</h3>
                        <div className="post-meta">
                          <span>{post.author}</span>
                          <span>â€¢</span>
                          <span>{post.date}</span>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          ) : (
            <div className="no-selection">
              <div className="no-selection-icon">ğŸ“‹</div>
              <h3 className="no-selection-title">ê²Œì‹œíŒì„ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
              <p className="no-selection-text">ì¢Œì¸¡ì—ì„œ ê²Œì‹œíŒì„ ì„ íƒí•˜ê±°ë‚˜ ìƒˆë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
            </div>
          )}
        </main>
      </div>

      {/* ê²Œì‹œíŒ ìƒì„± ëª¨ë‹¬ */}
      {showCreateModal && (
        <div className="modal-overlay" onClick={() => setShowCreateModal(false)}>
          <div className="modal-content" onClick={(e) => e.stopPropagation()}>
            <h2 className="modal-title">ìƒˆ ê²Œì‹œíŒ ë§Œë“¤ê¸°</h2>
            
            <div className="modal-form">
              <div className="form-group">
                <label className="form-label">ê²Œì‹œíŒ ì´ë¦„ *</label>
                <input
                  type="text"
                  value={newBoardName}
                  onChange={(e) => setNewBoardName(e.target.value)}
                  placeholder="ì˜ˆ: ê³µì§€ì‚¬í•­, ììœ ê²Œì‹œíŒ"
                  className="form-input"
                  autoFocus
                />
              </div>
              
              <div className="form-group">
                <label className="form-label">ì„¤ëª… (ì„ íƒ)</label>
                <textarea
                  value={newBoardDesc}
                  onChange={(e) => setNewBoardDesc(e.target.value)}
                  placeholder="ê²Œì‹œíŒì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                  className="form-textarea"
                  rows={3}
                />
              </div>
            </div>

            <div className="modal-actions">
              <button
                onClick={() => {
                  setShowCreateModal(false);
                  setNewBoardName('');
                  setNewBoardDesc('');
                }}
                className="btn-cancel"
              >
                ì·¨ì†Œ
              </button>
              <button
                onClick={handleCreateBoard}
                disabled={!newBoardName.trim()}
                className="btn-submit"
              >
                ìƒì„±í•˜ê¸°
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}